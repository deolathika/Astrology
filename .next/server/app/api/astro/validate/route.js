"use strict";(()=>{var e={};e.id=9206,e.ids=[9206],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},62113:(e,t,a)=>{a.r(t),a.d(t,{originalPathname:()=>m,patchFetch:()=>f,requestAsyncStorage:()=>p,routeModule:()=>d,serverHooks:()=>g,staticGenerationAsyncStorage:()=>h});var r={};a.r(r),a.d(r,{GET:()=>c});var i=a(49303),n=a(88716),s=a(60670),l=a(87070);class o{async validatePlanetaryPositions(e,t,a){try{let r=await this.fetchJPLData(t,a),i=[];for(let t of e){let e=r.find(e=>e.name.toLowerCase()===t.name.toLowerCase());if(e){let a=Math.abs(t.longitude-e.longitude),r=this.getTolerance(t.name),n=a<=r;i.push({planet:t.name,swissValue:t.longitude,jplValue:e.longitude,difference:a,tolerance:r,isValid:n})}}return i}catch(e){return[]}}async fetchJPLData(e,t){let a=`${e.toISOString()}_${t.latitude}_${t.longitude}`,r=this.cache.get(a);if(r&&this.isCacheValid(a))return r;try{let r=e.toISOString().split("T")[0],i=e.toISOString().split("T")[1].split(".")[0],n=[];for(let e of["Sun","Moon","Mercury","Venus","Mars","Jupiter","Saturn","Uranus","Neptune","Pluto"])try{let a=await this.fetchPlanetData(e,r,i,t);a&&n.push(a)}catch(e){}return this.cache.set(a,n),n}catch(e){throw Error("Failed to fetch JPL data")}}async fetchPlanetData(e,t,a,r){let i={Sun:"10",Moon:"301",Mercury:"199",Venus:"299",Mars:"499",Jupiter:"599",Saturn:"699",Uranus:"799",Neptune:"899",Pluto:"999"}[e];if(!i)return null;let n=new URLSearchParams({format:"json",COMMAND:i,OBJ_DATA:"YES",MAKE_EPHEM:"YES",EPHEM_TYPE:"OBSERVER",CENTER:"coord",COORD_TYPE:"GEODETIC",SITE_COORD:`${r.longitude},${r.latitude},0`,START_TIME:`${t} ${a}`,STOP_TIME:`${t} ${a}`,STEP_SIZE:"1d",QUANTITIES:"1,9,20,23,24,25"}),s=await fetch(`${this.baseUrl}?${n}`),l=await s.json();if(l.result&&l.result.includes("$$SOE")){let r=l.result.split("\n").find(e=>e.includes("$$SOE")&&e.length>20);if(r){let i=r.trim().split(/\s+/);if(i.length>=6)return{name:e,longitude:parseFloat(i[1])||0,latitude:parseFloat(i[2])||0,distance:parseFloat(i[3])||0,speed:parseFloat(i[4])||0,timestamp:`${t} ${a}`}}}return null}getTolerance(e){return({Sun:.1,Moon:.2,Mercury:.1,Venus:.1,Mars:.1,Jupiter:.1,Saturn:.1,Uranus:.1,Neptune:.1,Pluto:.1})[e]||.1}isCacheValid(e){return!!this.cache.get(e)&&Date.now()-this.cache.get(`${e}_time`)<this.cacheExpiry}clearExpiredCache(){let e=Date.now();for(let[t,a]of this.cache.entries())t.endsWith("_time")&&e-a>this.cacheExpiry&&(this.cache.delete(t),this.cache.delete(t.replace("_time","")))}getValidationSummary(e){let t=e.filter(e=>e.isValid).length,a=e.length-t,r=e.reduce((e,t)=>e+t.difference,0)/e.length,i=Math.max(...e.map(e=>e.difference));return{total:e.length,valid:t,invalid:a,averageDifference:r,worstDifference:i}}constructor(){this.baseUrl="https://ssd-api.jpl.nasa.gov/horizons.api",this.cache=new Map,this.cacheExpiry=864e5}}let u=new o;async function c(e){try{let{searchParams:t}=new URL(e.url),a=t.get("profileId"),r=t.get("date");if(!a)return l.NextResponse.json({error:"Profile ID required"},{status:400});let i={latitude:40.7128,longitude:-74.006},n=r?new Date(r):new Date,s={latitude:i.latitude,longitude:i.longitude},o=await u.validatePlanetaryPositions([{name:"Sun",longitude:85.2},{name:"Moon",longitude:120.5},{name:"Mercury",longitude:90.1},{name:"Venus",longitude:95.3},{name:"Mars",longitude:110.7}],n,s),c=u.getValidationSummary(o);return l.NextResponse.json({success:!0,validation:{results:o,summary:c,timestamp:new Date().toISOString(),source:"nasa_jpl_validation"}})}catch(e){return l.NextResponse.json({error:"Validation failed"},{status:500})}}let d=new i.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/astro/validate/route",pathname:"/api/astro/validate",filename:"route",bundlePath:"app/api/astro/validate/route"},resolvedPagePath:"/Users/lathikadissanayaka/P E R S O N A L/daily_secrets_app/src/app/api/astro/validate/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:p,staticGenerationAsyncStorage:h,serverHooks:g}=d,m="/api/astro/validate/route";function f(){return(0,s.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:h})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[9276,5972],()=>a(62113));module.exports=r})();